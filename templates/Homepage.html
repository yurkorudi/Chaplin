<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Chaplin cinema</title>
  <link rel="stylesheet" href="/static/css/globals.css">
  <link rel="stylesheet" href="/static/css/style.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
</head>

<body class="fade-in">
  <div class="home">
    {% include('header.html') %}
      
      
  <main class="main homePage">
     <div class="session-row">
      <div class="sessions">
        <p>üïí –ù–∞–π–±–ª–∏–∂—á—ñ —Å–µ–∞–Ω—Å–∏</p>
        <div class="nearest">
          {% for movie in movies[-2:] %}
          <div class="mst_sesion">
            <div id="slide" class="slide">
                <input type="image" , src="{{ movie.img_src }}">
                <a href="{{ url_for('movie', movie_name=movie.name) }}">
                  <div class="slider-film-back">
                    <div class="slider-film-button">
                      <button>‚Ñπ</button>
                      <p>–Ü–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø—Ä–æ —Ñ—ñ–ª—å–º</p>
                      <button>‚ñ∂</button>
                      <p>–ü–µ—Ä–µ–≥–ª—è–Ω—É—Ç —Ç—Ä–µ–π–ª–µ—Ä</p>
                    </div>
                    <div class="slider-film-info">
                      <p>–ù–∞–∑–≤–∞: {{ movie.name }}</p>
                      <p>–ñ–∞–Ω—Ä: {{ movie.genre }}</p>
                      <p>–¢—Ä–∏–≤–∞–ª—ñ—Å—Ç—å: {{ movie.duration }}</p>
                      <p>–í—ñ–∫: {{ movie.age }}</p>
                    </div>
                  </div>
                  <div class="inf">
                    <div class="d">2D</div>
                    <div class="age">{{ movie.age }}</div>
                  </div>
                </a>
                
              </div>
          </div>
          <!-- <button class="book_button">üé´ Time</button> -->
          {% endfor %}
        </div>
        <!-- <div class="weekly">
          <p>üóìÔ∏è –ü—Ä–µ–º'—î—Ä–∏ —Ç–∏–∂–Ω—è</p>

          <a href="">üé¨ Test</a>
        </div> -->
      </div>
    </div>
    
    <h1>–ü—Ä–µ–º'—î—Ä–∏ —Ç–∏–∂–Ω—è</h1>

    
    
    <!-- Home page's base 360 degris's slider -->
      <div class="slideshow">
        <div class="slide-track">
              {% for movie in movies[-6:] %}
              <div id="slide" class="slide">
                <input type="image" , src="{{ movie.img_src }}">
                <a href="{{ url_for('movie', movie_name=movie.name) }}">
                  <div class="slider-film-back">
                    <div class="slider-film-button">
                      <button>‚Ñπ</button>
                      <p>–Ü–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø—Ä–æ —Ñ—ñ–ª—å–º</p>
                      <button>‚ñ∂</button>
                      <p>–ü–µ—Ä–µ–≥–ª—è–Ω—É—Ç —Ç—Ä–µ–π–ª–µ—Ä</p>
                    </div>
                    <div class="slider-film-info">
                      <p>–ù–∞–∑–≤–∞: {{ movie.name }}</p>
                      <p>–ñ–∞–Ω—Ä: {{ movie.genre }}</p>
                      <p>–¢—Ä–∏–≤–∞–ª—ñ—Å—Ç—å: {{ movie.duration }}</p>
                      <p>–í—ñ–∫: {{ movie.age }}</p>
                    </div>
                  </div>
                  <div class="inf">
                    <div class="d">2D</div>
                    <div class="age">{{ movie.age }}</div>
                  </div>
                </a>
                
              </div>
            {% endfor %}
          </div>
          
        </div>
      

    <!-- end home page's base 360 degris's slider -->
    
  </main>

  {% include('footer.html') %}
{% if not mobile %}
  <script>
    
    const track = document.querySelector('.slide-track');
    const slides = document.querySelectorAll('.slide');
    const slideWidth = 300;

    let offset = 0;
    let lastX = 0;
    let isDragging = false;

    // –¥—É–±–ª—é—î–º–æ –¥–ª—è —Ü–∏–∫–ª—É
    track.innerHTML += track.innerHTML;

    // —Ä–µ–Ω–¥–µ—Ä –∑ –Ω–µ—Å–∫—ñ–Ω—á–µ–Ω–Ω–∏–º —Ü–∏–∫–ª–æ–º
    function render() {
        const fullWidth = slideWidth  * slides.length * slides.length;

        if (offset < -fullWidth) offset += fullWidth;
        if (offset > 0) offset -= fullWidth;

        track.style.transform = `translateX(${offset}px)`;
        requestAnimationFrame(render);
    }
    render();

    // –†—É—Ö
    function dragMove(x) {
        if (!isMouseDown) return; // ‚ùó –±–µ–∑ —Ü—å–æ–≥–æ –ù–Ü–ß–û–ì–û –Ω–µ —Ä—É—Ö–∞—î–º–æ

        const dx = x - lastX;
        lastX = x;

        offset += dx;
    }

    let isMouseDown = false;

    track.addEventListener("mousedown", (e) => {
      isMouseDown = true;
      lastX = e.clientX;
      console.log("–ö–Ω–æ–ø–∫–∞ –º–∏—à—ñ –∑–∞—Ç–∏—Å–Ω—É—Ç–∞, button:", e.button);
    });

    track.addEventListener("mouseup", (e) => {
      isMouseDown = false;
      console.log("–ö–Ω–æ–ø–∫–∞ –º–∏—à—ñ –≤—ñ–¥–ø—É—â–µ–Ω–∞, button:", e.button);
    });

    track.addEventListener("mousemove", (e) => {
      if (isMouseDown) {
        console.log("–¢—Ä–∏–º–∞—î–º–æ –∫–Ω–æ–ø–∫—É —ñ —Ä—É—Ö–∞—î–º–æ –º–∏—à—É. x:", e.clientX, "y:", e.clientY);
        dragMove(e.clientX);
      }
    });
  </script>
{% endif %}
</body>

</html>